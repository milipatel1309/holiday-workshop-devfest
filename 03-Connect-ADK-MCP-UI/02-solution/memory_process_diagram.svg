<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 450" style="font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;">
  <defs>
    <filter id="softShadow" x="-20%" y="-20%" width="140%" height="140%">
      <feGaussianBlur in="SourceAlpha" stdDeviation="4"/>
      <feOffset dx="3" dy="3" result="offsetblur"/>
      <feComponentTransfer>
        <feFuncA type="linear" slope="0.15"/>
      </feComponentTransfer>
      <feMerge>
        <feMergeNode/>
        <feMergeNode in="SourceGraphic"/>
      </feMerge>
    </filter>
    <linearGradient id="step1Gradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#E3F2FD;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#BBDEFB;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="step2Gradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#F3E5F5;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E1BEE7;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="step3Gradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#E8F5E9;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#C8E6C9;stop-opacity:1" />
    </linearGradient>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#78909C" />
    </marker>
  </defs>

  <!-- Background -->
  <rect width="100%" height="100%" fill="#ffffff"/>

  <!-- Title -->
  <text x="500" y="40" fill="#37474F" font-size="28" font-weight="bold" text-anchor="middle">Vertex AI Memory Bank Workflow</text>
  <text x="500" y="65" fill="#78909C" font-size="16" text-anchor="middle">Automated Lifecycle of a Memory</text>

  <!-- =========================================
       STEP 1: EXTRACTION
       ========================================= -->
  <g transform="translate(60, 110)">
    <!-- Badge -->
    <circle cx="20" cy="0" r="15" fill="#42A5F5"/>
    <text x="20" y="5" fill="#FFF" font-size="14" font-weight="bold" text-anchor="middle">1</text>
    
    <!-- Card -->
    <rect x="0" y="20" width="260" height="280" rx="15" fill="url(#step1Gradient)" stroke="#90CAF9" stroke-width="2" filter="url(#softShadow)"/>
    <text x="130" y="50" font-size="30" text-anchor="middle">‚õèÔ∏è</text>
    <text x="130" y="80" fill="#1565C0" font-size="18" font-weight="bold" text-anchor="middle">Memory Extraction</text>
    
    <!-- Code Reference -->
    <text x="130" y="100" fill="#1E88E5" font-size="11" font-family="monospace" text-anchor="middle">deploy_agent.custom_topics</text>
    
    <!-- Visual Content -->
    <g transform="translate(20, 120)">
        <!-- Input Bubble -->
         <rect width="220" height="40" rx="10" fill="#FFFFFF"/>
         <text x="10" y="25" fill="#546E7A" font-size="11" font-style="italic">User: "I love blue sweaters!"</text>
         
         <!-- Arrow Down -->
         <line x1="110" y1="45" x2="110" y2="70" stroke="#1565C0" stroke-width="2" marker-end="url(#arrow)"/>
         
         <!-- Filter/Topic -->
         <rect y="75" width="220" height="60" rx="8" fill="#BBDEFB" stroke="#64B5F6" stroke-dasharray="4"/>
         <text x="110" y="100" fill="#0D47A1" font-size="11" font-weight="bold" text-anchor="middle">Topic Match: sweater_preference</text>
         <text x="110" y="120" fill="#1565C0" font-size="11" text-anchor="middle">Extracts: "Preference: Blue"</text>
    </g>
  </g>

  <!-- Arrow 1-2 -->
  <g transform="translate(330, 250)">
    <line x1="0" y1="0" x2="40" y2="0" stroke="#B0BEC5" stroke-width="3" marker-end="url(#arrow)"/>
  </g>

  <!-- =========================================
       STEP 2: CONSOLIDATION
       ========================================= -->
  <g transform="translate(380, 110)">
    <!-- Badge -->
    <circle cx="20" cy="0" r="15" fill="#AB47BC"/>
    <text x="20" y="5" fill="#FFF" font-size="14" font-weight="bold" text-anchor="middle">2</text>
    
    <!-- Card -->
    <rect x="0" y="20" width="260" height="280" rx="15" fill="url(#step2Gradient)" stroke="#CE93D8" stroke-width="2" filter="url(#softShadow)"/>
    <text x="130" y="50" font-size="30" text-anchor="middle">üß©</text>
    <text x="130" y="80" fill="#6A1B9A" font-size="18" font-weight="bold" text-anchor="middle">Consolidation</text>
    
    <!-- Subtitle -->
    <text x="130" y="100" fill="#8E24AA" font-size="11" text-anchor="middle">Merging New + Old</text>
    
    <!-- Visual Content -->
    <g transform="translate(20, 120)">
        <!-- Old Memory -->
        <rect width="220" height="30" rx="5" fill="#F3E5F5" stroke="#BA68C8"/>
        <text x="10" y="20" fill="#7B1FA2" font-size="10">Old: "Likes snowflake patterns"</text>
        
        <!-- New Fact -->
        <text x="110" y="45" fill="#8E24AA" font-size="14" font-weight="bold" text-anchor="middle">+</text>
        <text x="110" y="60" fill="#4A148C" font-size="10" font-weight="bold" text-anchor="middle">"Preference: Blue"</text>
        
        <!-- Result -->
        <line x1="110" y1="70" x2="110" y2="90" stroke="#8E24AA" stroke-width="2" marker-end="url(#arrow)"/>
        
        <rect y="95" width="220" height="50" rx="8" fill="#FFFFFF" stroke="#8E24AA" stroke-width="2"/>
        <text x="110" y="115" fill="#4A148C" font-size="11" font-weight="bold" text-anchor="middle">Evolved Memory:</text>
        <text x="110" y="132" fill="#7B1FA2" font-size="10" text-anchor="middle">"Likes Blue Snowflake Sweaters"</text>
    </g>
  </g>

  <!-- Arrow 2-3 -->
  <g transform="translate(650, 250)">
     <line x1="0" y1="0" x2="40" y2="0" stroke="#B0BEC5" stroke-width="3" marker-end="url(#arrow)"/>
  </g>

  <!-- =========================================
       STEP 3: ASYNC GENERATION
       ========================================= -->
  <g transform="translate(700, 110)">
    <!-- Badge -->
    <circle cx="20" cy="0" r="15" fill="#66BB6A"/>
    <text x="20" y="5" fill="#FFF" font-size="14" font-weight="bold" text-anchor="middle">3</text>
    
    <!-- Card -->
    <rect x="0" y="20" width="260" height="280" rx="15" fill="url(#step3Gradient)" stroke="#A5D6A7" stroke-width="2" filter="url(#softShadow)"/>
    <text x="130" y="50" font-size="30" text-anchor="middle">‚ö°</text>
    <text x="130" y="80" fill="#2E7D32" font-size="18" font-weight="bold" text-anchor="middle">Async Generation</text>
    
    <!-- Subtitle -->
    <text x="130" y="100" fill="#388E3C" font-size="11" text-anchor="middle">Non-Blocking Agent</text>
    
    <!-- Visual Content -->
    <g transform="translate(20, 120)">
         <!-- Cloud Process -->
         <path d="M40,20 Q50,0 70,20 Q90,10 110,25 Q130,10 150,25  Q170,10 190,30 Q210,40 200,60 Q210,80 180,80 H40 Q10,80 20,60 Q0,40 40,20" fill="#FFFFFF" stroke="#4CAF50" stroke-width="2"/>
         <text x="110" y="55" fill="#2E7D32" font-size="11" font-weight="bold" text-anchor="middle">Processing...</text>
         
         <!-- Agent Status -->
         <rect y="100" width="220" height="40" rx="8" fill="#E8F5E9" stroke="#81C784"/>
         <text x="10" y="125" fill="#1B5E20" font-size="11">Agent: "I'm free to reply!"</text>
         <circle cx="200" cy="120" r="5" fill="#4CAF50"/>
    </g>
  </g>

  <!-- Footer Info -->
  <text x="500" y="420" fill="#90A4AE" font-size="12" font-style="italic" text-anchor="middle">Configured in deploy_agent.py ‚Ä¢ Stored in Vertex AI Agent Engine</text>

</svg>
